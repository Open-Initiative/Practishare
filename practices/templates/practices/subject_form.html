{% extends 'base.html' %}
{% load i18n %}
{% load bootstrap %}

{% block pagetitle %}{{ subject.title | default:_("Nouveau Sujet") }}{% endblock %}

{% block contenttitle %}{{ subject.title | default:_("Nouveau Sujet") }}{% endblock %}

{% block scripts %}
<script type="text/javascript">
    function addForm(newFormDiv, targetDiv) { 
        var formIdx = targetDiv.querySelector('[id$=TOTAL_FORMS]').value;
        var newForm = document.createElement('div');
        newForm.innerHTML = newFormDiv.innerHTML.replace(/__prefix__/g, formIdx);
        while (newForm.firstChild) targetDiv.appendChild(newForm.firstChild);
        targetDiv.querySelector('[id$=TOTAL_FORMS]').value = parseInt(formIdx) + 1;
    }
</script>
{% endblock %}

{% block content %}

<h3>Introduction :</h3>

<p>Ce formulaire vous permet de configurer votre practishare en deux temps, en indiquant :</p> 

<ul>
    <li>un titre, les noms des 2 axes de votre tableau ainsi que leur nombre de valeurs, le nombre de champs qui décrivent une pratique</li>
    <li>les valeurs des axes, ainsi que des champs descriptifs</li>
</ul>

<h3>Questions :</h3>
<ul>
    <li>Indiquer le titre de votre practishare.</li>
    <li>Souhaitez-vous que ce practishare soit public (référencé dans la catalogue) ?</li>
    <li>Indiquer les titres des axes du tableau et leur nombre de valeurs</li>
    <li>Indiquer le nombre de champs descriptifs</li>
    <li>Indiquer les valeurs des axes (entêtes du tableau).</li>
    <li>Indiquer les noms des champs descriptifs de vos pratiques.</li>
</ul>
<h2 class="title-border">Titre</h2>

<form class="form-horizontal" action="" method="post">
    {% csrf_token %}
    {% for form in forms %}

        {% if form.prefix = 'axis_set' %}<h2 class="title-border">Axes</h2>

        {% elif form.prefix = 'field_set' %}<h2 class="title-border">Champs</h2>

        {% elif form.prefix|slice:':4' = 'axis' %}

        <h2 class="title-border"> {{ form.instance.title}} </h2>

        {% endif %}
        <div>
            {{form|bootstrap_horizontal}}
        </div>
        {% if form.max_num > 2 %}
        <button type='button' onclick="addForm(this.nextElementSibling, this.previousElementSibling)" class="btn-action add-btn">Ajouter</button>
        <div style="display:none">
            <div class="clearfix"></div>
            {{ form.empty_form|bootstrap_horizontal }}
        </div>
        {% endif %}

    {% endfor %}

    <div class="btn-toolbar">
        <span class="btn btn-action" onclick="window.history.back();return false">{% trans 'Cancel' %}</span>
        <input type="submit" value="{% trans 'Submit' %}" class="btn btn-action"/>
    </div>
</form>
{% endblock %}
